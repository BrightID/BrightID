name: Appcenter codepush
on:
  push:
    branches:
      - automate_staging_deploy
jobs:
    deploy:
        if: github.repository_owner == 'BrightID'
        name: Deploy Staging
        runs-on: ubuntu-latest
        steps:
            - name: Checkout Repo
              uses: actions/checkout@master
            - name: Install Dependencies
              run: npm install
            - name: Deploy to Codepush - Android
              uses: NishanthShankar/codepush-action@master
              with:
                  args: release-react -a BrightID/BrightID-android -d Staging
              env:
                  APPCENTER_ACCESS_TOKEN: ${{ secrets.APPCENTER_ACCESS_TOKEN }}
            - name: Deploy to Codepush - iOS
              uses: NishanthShankar/codepush-action@master
              with:
                  args: release-react -a BrightID/BrightID-ios -d Staging
              env:
                  APPCENTER_ACCESS_TOKEN: ${{ secrets.APPCENTER_ACCESS_TOKEN }}
